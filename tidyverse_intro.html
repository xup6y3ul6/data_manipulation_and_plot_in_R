<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Data Manipulation and Plot in R</title>
    <meta charset="utf-8" />
    <meta name="author" content="林子堯 楊昊紘" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
    <script src="libs/jquery-1.12.4/jquery.min.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.9/datatables.js"></script>
    <link href="libs/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.10.19/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="my-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Data Manipulation and Plot in R
## dplyr, tidyr and ggplot2
### 林子堯 楊昊紘
### 2020/03/28 Sat.

---




# Download: &lt;https://bit.ly/39a7RCI&gt;

.center[![](figure/qr.ioi.tw.png)]


```r
# install.packages(tidyverse)
library(tidyverse) # including dplyr, tidyr, &amp; ggplot ...
```

---

# Outline

.Large[
- introduction
- data.frame
- dplyr
- tidyr
- ggplot2
]

---

# Motivation

Data preprocessing takes 50-80% of your time in data analysis

Goal of Data Preprocessing  
- Make data suitable to use with a particular piece of software (i.e. R, Python)  
- Reveal important information  
- Extract variables to analyze

---

# Hadley Wickham

- The Man Who Revolutionized R
- The Committee of Presidents of Statistical Societies Awards
- [tidyverse](https://www.tidyverse.org/)
.center[![:scale 90%](figure/HadleyWickham-R.jpg)]

---

.center[![](figure/ChartHadley.png)]

---

.center[![](figure/package download.png)]

---

# R packages for data science

.center[![:scale 90%](figure/tidyverse_data_science.png)]

---
class: inverse, center, middle

# data.frame

---

# data.frame(): create


```r
student &lt;- data.frame(
  ID = LETTERS[1:12], 
  math = round(rnorm(12, 50, 15), 1),
  chinese = seq(4, 92, length.out = 12))
student
```

```
   ID math chinese
1   A 37.7       4
2   B 41.8      12
3   C 30.1      20
4   D 42.1      28
5   E 63.6      36
6   F 62.6      44
7   G 61.7      52
8   H 40.2      60
9   I 32.6      68
10  J 51.4      76
11  K 37.1      84
12  L 43.8      92
```

--- 

# data.frame(): create

load data

```r
ebg_011 &lt;- read.csv("data/011_b_1114_1_1_p1.csv", 
                   fileEncoding = "UTF-8")
head(ebg_011)
```

```
  Trials MarketCondition StockPrice p1Cash p1Stock p1TotalAsset p1Decision
1      1               1        100  10000      10        11000        buy
2      2               1        103   9900      11        11033        buy
3      3               1        103   9797      12        11033        buy
4      4               1        103   9694      13        11033        buy
5      5               1        107   9591      14        11089        buy
6      6               1        107   9484      15        11089        buy
  p1ChechHistory
1             no
2             no
3             no
4             no
5             no
6             no
```

```r
class(ebg_011)
```

```
[1] "data.frame"
```

---

# data.frame(): read


```r
# []
ebg_011[1]
ebg_011["p1Cash"]

# [,]
ebg_011[1, 3]
ebg_011[1:10, 2:3]

# [[]]
ebg_011[[1]]

# $
ebg_011$StockPrice
ebg_011$p1Decision[61:100]
typeof(ebg_011)
```

---

# data.frame(): update


```r
student$psychology &lt;- rep(c(59, 61), each = 2, times = 3)
student
```

```
   ID math chinese psychology
1   A 37.7       4         59
2   B 41.8      12         59
3   C 30.1      20         61
4   D 42.1      28         61
5   E 63.6      36         59
6   F 62.6      44         59
7   G 61.7      52         61
8   H 40.2      60         61
9   I 32.6      68         59
10  J 51.4      76         59
11  K 37.1      84         61
12  L 43.8      92         61
```


---
class: inverse, center, middle

# dplyr

---

# tibble


```r
# install.packages("nycflights13")
data(flights, package = "nycflights13")
flights
```

```
# A tibble: 336,776 x 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ... with 336,766 more rows, and 11 more variables: arr_delay &lt;dbl&gt;,
#   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
#   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;
```

---

# select()


```r
flight1 &lt;- select(flights, month:day, tailnum, 
                  arr_delay, dep_delay, distance, air_time)
flight1
```

```
# A tibble: 336,776 x 7
   month   day tailnum arr_delay dep_delay distance air_time
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1     1     1 N14228         11         2     1400      227
 2     1     1 N24211         20         4     1416      227
 3     1     1 N619AA         33         2     1089      160
 4     1     1 N804JB        -18        -1     1576      183
 5     1     1 N668DN        -25        -6      762      116
 6     1     1 N39463         12        -4      719      150
 7     1     1 N516JB         19        -5     1065      158
 8     1     1 N829AS        -14        -3      229       53
 9     1     1 N593JB         -8        -3      944      140
10     1     1 N3ALAA          8        -2      733      138
# ... with 336,766 more rows
```

---

# filter()


```r
filter(flight1, month == 5, day %in% c(1, 2, 3), arr_delay &gt; 0)
```

```
# A tibble: 844 x 7
   month   day tailnum arr_delay dep_delay distance air_time
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1     5     1 N628VA        408       434     2475      341
 2     5     1 N196UW          1        -9      529       94
 3     5     1 N174AT          2        -1      762      113
 4     5     1 N751UW          7       -10      541       88
 5     5     1 N359NB          4        -8      746      114
 6     5     1 N564UW          6        -6      529       83
 7     5     1 N482UA         13         0     1416      197
 8     5     1 N13550         27         9      416       72
 9     5     1 N539UW          2        -6      529       84
10     5     1 N750UW          3        -5      214       36
# ... with 834 more rows
```

---

# sample_n() and sample_frac()


```r
sample_n(flight1, 4) # fixed number
```

```
# A tibble: 4 x 7
  month   day tailnum arr_delay dep_delay distance air_time
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1     9    20 N368JB        -22       -13      200       42
2     7    14 N13123        -13        -7      594       87
3     8     3 N654AW         18        11     2133      284
4     3     1 N853MQ        -32        -7      427       67
```

```r
sample_frac(flight1, 0.00001) # fixed fraction
```

```
# A tibble: 3 x 7
  month   day tailnum arr_delay dep_delay distance air_time
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1     3     9 N27724         -6         5     2434      332
2    11    16 N37465        -11        -2     1504      229
3     5     8 N11113        133       120      628       91
```

---

# arrange()


```r
arrange(flight1, distance)
```

```
# A tibble: 336,776 x 7
   month   day tailnum arr_delay dep_delay distance air_time
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1     7    27 &lt;NA&gt;           NA        NA       17       NA
 2     1     3 N13989         -2        -2       80       30
 3     1     4 N14972         27        40       80       30
 4     1     4 N15983        136       134       80       28
 5     1     4 N27962         -6        -1       80       32
 6     1     5 N14902        -25        -5       80       29
 7     1     6 N22909          0        -4       80       22
 8     1     7 N33182        -12        -5       80       25
 9     1     8 N11194         39        -3       80       30
10     1     9 N17560         -7        -3       80       27
# ... with 336,766 more rows
```

---

# arrange(desc())


```r
arrange(flight1, desc(month), desc(day))
```

```
# A tibble: 336,776 x 7
   month   day tailnum arr_delay dep_delay distance air_time
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1    12    31 N566JB          2        14     1576      189
 2    12    31 N713TW          5        19     1598      192
 3    12    31 N374JB         96       101      273       50
 4    12    31 N557UW          4        -1      529       95
 5    12    31 N470UA          2        -1     1400      223
 6    12    31 N577UA         25        -2     2454      346
 7    12    31 N3CXAA        -20       -10      733      127
 8    12    31 N14916        -15        -8      645      118
 9    12    31 N333NB        -13        -7      502       86
10    12    31 N552JB         -3         4     1576      195
# ... with 336,766 more rows
```

---

# mutate()


```r
mutate(flight1,
       gain = arr_delay - dep_delay,
       speed = distance / air_time * 60)
```

```
# A tibble: 336,776 x 9
   month   day tailnum arr_delay dep_delay distance air_time  gain speed
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     1     1 N14228         11         2     1400      227     9  370.
 2     1     1 N24211         20         4     1416      227    16  374.
 3     1     1 N619AA         33         2     1089      160    31  408.
 4     1     1 N804JB        -18        -1     1576      183   -17  517.
 5     1     1 N668DN        -25        -6      762      116   -19  394.
 6     1     1 N39463         12        -4      719      150    16  288.
 7     1     1 N516JB         19        -5     1065      158    24  404.
 8     1     1 N829AS        -14        -3      229       53   -11  259.
 9     1     1 N593JB         -8        -3      944      140    -5  405.
10     1     1 N3ALAA          8        -2      733      138    10  319.
# ... with 336,766 more rows
```

---

# select(mutate())



```r
select(
  mutate(flight1, 
         gain = arr_delay - dep_delay, 
         speed = distance / air_time * 60
  ),
  gain, speed
)
```

```
# A tibble: 336,776 x 2
    gain speed
   &lt;dbl&gt; &lt;dbl&gt;
 1     9  370.
 2    16  374.
 3    31  408.
 4   -17  517.
 5   -19  394.
 6    16  288.
 7    24  404.
 8   -11  259.
 9    -5  405.
10    10  319.
# ... with 336,766 more rows
```

---

# transmute() == select(mutate())


```r
transmute(flight1, 
          gain = arr_delay - dep_delay,
          speed = distance / air_time * 60)
```

```
# A tibble: 336,776 x 2
    gain speed
   &lt;dbl&gt; &lt;dbl&gt;
 1     9  370.
 2    16  374.
 3    31  408.
 4   -17  517.
 5   -19  394.
 6    16  288.
 7    24  404.
 8   -11  259.
 9    -5  405.
10    10  319.
# ... with 336,766 more rows
```

---

# nested structure 

It is very hard to read ...


```r
filter(
  summarise(
    select(
      group_by(flight1, month, day),
      arr_delay, dep_delay
    ),
    arr = mean(arr_delay, na.rm = TRUE),
    dep = mean(dep_delay, na.rm = TRUE)
  ),
  arr &gt; 30 | dep &gt; 30
)
```


---

# pipe operator %&gt;%


```r
flight1 %&gt;% 
  mutate(gain = arr_delay - dep_delay, 
         speed = distance / air_time * 60) %&gt;% 
  select(gain, speed)
```

```
# A tibble: 336,776 x 2
    gain speed
   &lt;dbl&gt; &lt;dbl&gt;
 1     9  370.
 2    16  374.
 3    31  408.
 4   -17  517.
 5   -19  394.
 6    16  288.
 7    24  404.
 8   -11  259.
 9    -5  405.
10    10  319.
# ... with 336,766 more rows
```

---

# summarise()


```r
flight1 %&gt;% 
  summarise(delay_mean = mean(dep_delay, na.rm = TRUE), 
            delay_sd = sd(dep_delay, na.rm = TRUE))
```

```
# A tibble: 1 x 2
  delay_mean delay_sd
       &lt;dbl&gt;    &lt;dbl&gt;
1       12.6     40.2
```

---

# group_by() %&gt;% summarise()


```r
flight1 %&gt;%
  group_by(month) %&gt;% 
  summarise(delay_mean = mean(dep_delay, na.rm = TRUE), 
            delay_sd = sd(dep_delay, na.rm = TRUE))
```

```
# A tibble: 12 x 3
   month delay_mean delay_sd
   &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;
 1     1      10.0      36.4
 2     2      10.8      36.3
 3     3      13.2      40.1
 4     4      13.9      43.0
 5     5      13.0      39.4
 6     6      20.8      51.5
 7     7      21.7      51.6
 8     8      12.6      37.7
 9     9       6.72     35.6
10    10       6.24     29.7
11    11       5.44     27.6
12    12      16.6      41.9
```


---

# left_join()

.pull-left[

```r
flights2 &lt;- flights %&gt;% 
  select(month:day, tailnum, carrier) 
flights2 %&gt;% head()
```

```
# A tibble: 6 x 4
  month   day tailnum carrier
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  
1     1     1 N14228  UA     
2     1     1 N24211  UA     
3     1     1 N619AA  AA     
4     1     1 N804JB  B6     
5     1     1 N668DN  DL     
6     1     1 N39463  UA     
```
]

.pull-right[

```r
data(airlines, package = "nycflights13")
airlines %&gt;% head()
```

```
# A tibble: 6 x 2
  carrier name                    
  &lt;chr&gt;   &lt;chr&gt;                   
1 9E      Endeavor Air Inc.       
2 AA      American Airlines Inc.  
3 AS      Alaska Airlines Inc.    
4 B6      JetBlue Airways         
5 DL      Delta Air Lines Inc.    
6 EV      ExpressJet Airlines Inc.
```
]

---

# left_join()


```r
flights2 %&gt;% 
  left_join(airlines)
```

```
Joining, by = "carrier"
```

```
# A tibble: 336,776 x 5
   month   day tailnum carrier name                    
   &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                   
 1     1     1 N14228  UA      United Air Lines Inc.   
 2     1     1 N24211  UA      United Air Lines Inc.   
 3     1     1 N619AA  AA      American Airlines Inc.  
 4     1     1 N804JB  B6      JetBlue Airways         
 5     1     1 N668DN  DL      Delta Air Lines Inc.    
 6     1     1 N39463  UA      United Air Lines Inc.   
 7     1     1 N516JB  B6      JetBlue Airways         
 8     1     1 N829AS  EV      ExpressJet Airlines Inc.
 9     1     1 N593JB  B6      JetBlue Airways         
10     1     1 N3ALAA  AA      American Airlines Inc.  
# ... with 336,766 more rows
```

---

# left_join()

.pull-left[

```r
(df1 &lt;- tibble(x = c(1, 2), 
               y = 2:1))
```

```
# A tibble: 2 x 2
      x     y
  &lt;dbl&gt; &lt;int&gt;
1     1     2
2     2     1
```
]

.pull-right[

```r
(df2 &lt;- tibble(x = c(1, 3), 
  a = 10, b = "HI"))
```

```
# A tibble: 2 x 3
      x     a b    
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
1     1    10 HI   
2     3    10 HI   
```
]

--


```r
df1 %&gt;% left_join(df2)
```

```
Joining, by = "x"
```

```
# A tibble: 2 x 4
      x     y     a b    
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;
1     1     2    10 HI   
2     2     1    NA &lt;NA&gt; 
```

---

# right_join()

.pull-left[

```r
(df1 &lt;- tibble(x = c(1, 2), 
               y = 2:1))
```

```
# A tibble: 2 x 2
      x     y
  &lt;dbl&gt; &lt;int&gt;
1     1     2
2     2     1
```
]

.pull-right[

```r
(df2 &lt;- tibble(x = c(1, 3), 
  a = 10, b = "HI"))
```

```
# A tibble: 2 x 3
      x     a b    
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
1     1    10 HI   
2     3    10 HI   
```
]

--


```r
df1 %&gt;% right_join(df2)
```

```
Joining, by = "x"
```

```
# A tibble: 2 x 4
      x     y     a b    
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;
1     1     2    10 HI   
2     3    NA    10 HI   
```

---

# inner_join()

.pull-left[

```r
(df1 &lt;- tibble(x = c(1, 2), 
               y = 2:1))
```

```
# A tibble: 2 x 2
      x     y
  &lt;dbl&gt; &lt;int&gt;
1     1     2
2     2     1
```
]

.pull-right[

```r
(df2 &lt;- tibble(x = c(1, 3), 
  a = 10, b = "HI"))
```

```
# A tibble: 2 x 3
      x     a b    
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
1     1    10 HI   
2     3    10 HI   
```
]

--


```r
df1 %&gt;% inner_join(df2)
```

```
Joining, by = "x"
```

```
# A tibble: 1 x 4
      x     y     a b    
  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;
1     1     2    10 HI   
```

---

# Practice 1

試著將同一組的 player 1 和 player 2 這兩筆資料給合併在同一個表格

--


```r
ebg_012 &lt;- read.csv("data/012_b_1114_1_1_p2.csv", 
                   fileEncoding = "UTF-8")
ebg_g1 &lt;- ebg_011 %&gt;% 
  left_join(ebg_012) 
```

```
Joining, by = c("Trials", "MarketCondition", "StockPrice")
```

---

# Practice 1

試著將同一組的 player 1 和 player 2 這兩筆資料給合併在同一個表格

.scroll-box-18[
.small[
<div id="htmlwidget-3e5d2d812d9a51ec4f44" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3e5d2d812d9a51ec4f44">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[100,103,103,103,107,107,107,107,111,115,119,123,120,117,114,111,108,105,109,113,110,117,117,112,112,119,114,111,108,105,102,99,105,102,109,106,106,113,108,115,112,119,116,123,117,125,119,131,125,133,130,138,134,143,139,148,144,159,155,151,151,151,142,142,134,141,133,140,132,125,129,122,129,117,121,109,115,104,108,102,106,100,103,97,102,92,95,95,95,98,93,93,93,93,93,96,87,90,85,90,81],[10000,9900,9797,9694,9591,9484,9377,9270,9163,9052,8937,8818,8941,9061,9178,9292,9403,9511,9406,9297,9410,9300,9183,9300,9412,9300,9419,9533,9644,9752,9857,9959,9860,9965,9863,9972,9972,9866,9979,9871,9986,9874,9993,9877,10000,9883,10008,9889,10020,9895,10028,9898,10036,9902,10045,9906,10054,9910,10069,10224,10375,10526,10677,10819,10961,10827,10968,10835,10975,11107,10982,11111,10989,11118,11001,11122,11013,11128,11024,11132,11030,11136,11036,11139,11042,11144,11052,11052,11052,11052,11150,11057,11057,11057,11057,11057,11153,11066,11156,11071,11161],[10,11,12,13,14,15,16,17,18,19,20,21,20,19,18,17,16,15,16,17,16,17,18,17,16,17,16,15,14,13,12,11,12,11,12,11,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,10,9,8,7,6,5,6,5,6,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,4,5,5,5,5,4,5,5,5,5,5,4,5,4,5,4],[11000,11033,11033,11033,11089,11089,11089,11089,11161,11237,11317,11401,11341,11284,11230,11179,11131,11086,11150,11218,11170,11289,11289,11204,11204,11323,11243,11198,11156,11117,11081,11048,11120,11087,11171,11138,11138,11222,11167,11251,11218,11302,11269,11353,11287,11383,11317,11461,11395,11491,11458,11554,11510,11618,11574,11682,11638,11818,11774,11734,11734,11734,11671,11671,11631,11673,11633,11675,11635,11607,11627,11599,11634,11586,11606,11558,11588,11544,11564,11540,11560,11536,11551,11527,11552,11512,11527,11527,11527,11542,11522,11522,11522,11522,11522,11537,11501,11516,11496,11521,11485],["buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","sell","buy","buy","sell","sell","buy","sell","sell","sell","sell","sell","sell","buy","sell","buy","sell","no trade","buy","sell","buy","sell","buy","sell","buy","sell","buy","sell","buy","sell","buy","sell","buy","sell","buy","sell","buy","sell","buy","sell","sell","sell","sell","sell","sell","sell","buy","sell","buy","sell","sell","buy","sell","buy","sell","buy","sell","buy","sell","buy","sell","buy","sell","buy","sell","buy","sell","buy","no trade","no trade","no trade","sell","buy","no trade","no trade","no trade","no trade","sell","buy","sell","buy","sell",""],["no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","no","yes","yes","yes","yes","no","yes","no","yes","yes","no","yes","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","yes","yes","no","no","yes","yes","yes","yes","yes","yes","yes","yes","no","no","yes","yes","yes","yes","yes","yes","no","yes","yes","yes","no","no","no","no","yes","yes","yes","yes",""],[10000,10000,10103,10206,10206,10313,10420,10527,10527,10527,10527,10527,10527,10527,10527,10527,10527,10527,10527,10527,10527,10527,10644,10761,10649,10649,10768,10768,10768,10768,10768,10768,10768,10768,10768,10768,10768,10768,10881,10881,10881,10881,10881,10881,11004,11004,11129,11010,11141,11141,11141,11141,11141,11141,11141,11141,11141,10997,10997,10997,10846,10695,10695,10553,10553,10419,10419,10286,10286,10286,10286,10286,10164,10293,10293,10414,10305,10420,10420,10420,10420,10420,10420,10420,10323,10425,10425,10425,10425,10330,10330,10423,10423,10423,10423,10330,10426,10426,10426,10341,10431],[10,10,9,8,8,7,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,3,4,4,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,1,1,0,1,0,0,0,0,0,0,0,0,0,1,1,1,2,3,3,4,4,5,5,6,6,6,6,6,7,6,6,5,6,5,5,5,5,5,5,5,6,5,5,5,5,6,6,5,5,5,5,6,5,5,5,6,5],[11000,11030,11030,11030,11062,11062,11062,11062,11082,11102,11122,11142,11127,11112,11097,11082,11067,11052,11072,11092,11077,11112,11112,11097,11097,11125,11110,11101,11092,11083,11074,11065,11083,11074,11095,11086,11086,11107,11097,11111,11105,11119,11113,11127,11121,11129,11129,11141,11141,11141,11141,11141,11141,11141,11141,11141,11141,11156,11152,11148,11148,11148,11121,11121,11089,11124,11084,11126,11078,11036,11060,11018,11067,10995,11019,10959,10995,10940,10960,10930,10950,10920,10935,10905,10935,10885,10900,10900,10900,10918,10888,10888,10888,10888,10888,10906,10861,10876,10851,10881,10836],["no trade","sell","sell","no trade","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","buy","no trade","sell","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","sell","no trade","no trade","no trade","no trade","no trade","sell","no trade","sell","buy","sell","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","buy","no trade","no trade","buy","buy","no trade","buy","no trade","buy","no trade","buy","no trade","no trade","no trade","no trade","buy","sell","no trade","sell","buy","sell","no trade","no trade","no trade","no trade","no trade","no trade","buy","sell","no trade","no trade","no trade","buy","no trade","sell","no trade","no trade","no trade","buy","sell","no trade","no trade","buy","sell",""],["no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no",""]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Trials<\/th>\n      <th>MarketCondition<\/th>\n      <th>StockPrice<\/th>\n      <th>p1Cash<\/th>\n      <th>p1Stock<\/th>\n      <th>p1TotalAsset<\/th>\n      <th>p1Decision<\/th>\n      <th>p1ChechHistory<\/th>\n      <th>p2Cash<\/th>\n      <th>p2Stock<\/th>\n      <th>p2TotalAsset<\/th>\n      <th>p2Decision<\/th>\n      <th>p2ChechHistory<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"fixedColumns":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,9,10,11]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
]
]

---
class: inverse, center, middle

# tidyr

---

# long vs. wide table

![:scale 90%](figure/long-wide table.jpg)

---

# wide table


```r
student
```

```
   ID math chinese psychology
1   A 37.7       4         59
2   B 41.8      12         59
3   C 30.1      20         61
4   D 42.1      28         61
5   E 63.6      36         59
6   F 62.6      44         59
7   G 61.7      52         61
8   H 40.2      60         61
9   I 32.6      68         59
10  J 51.4      76         59
11  K 37.1      84         61
12  L 43.8      92         61
```

---

# pivot_longer()


```r
student_long &lt;- pivot_longer(student, 
  cols = c("math", "chinese", "psychology"), # -ID 
  names_to = "subjects", values_to = "score")
student_long
```

```
# A tibble: 36 x 3
   ID    subjects   score
   &lt;fct&gt; &lt;chr&gt;      &lt;dbl&gt;
 1 A     math        37.7
 2 A     chinese      4  
 3 A     psychology  59  
 4 B     math        41.8
 5 B     chinese     12  
 6 B     psychology  59  
 7 C     math        30.1
 8 C     chinese     20  
 9 C     psychology  61  
10 D     math        42.1
# ... with 26 more rows
```

---

# pivot_wider()


```r
student_wide &lt;- pivot_wider(student_long,
  names_from = "subjects", values_from = "score")
student_wide
```

```
# A tibble: 12 x 4
   ID     math chinese psychology
   &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;
 1 A      37.7       4         59
 2 B      41.8      12         59
 3 C      30.1      20         61
 4 D      42.1      28         61
 5 E      63.6      36         59
 6 F      62.6      44         59
 7 G      61.7      52         61
 8 H      40.2      60         61
 9 I      32.6      68         59
10 J      51.4      76         59
11 K      37.1      84         61
12 L      43.8      92         61
```

---

# Practice 2

試著把剛剛同組的 `ebg` 資料，利用 `boxplot(y~group, data)`，依照不同「資產類型」(Cash, Stock, Asset)，畫出它分佈。

--
.scroll-box-16[

```r
ebg_long &lt;- ebg_g1 %&gt;% 
    pivot_longer(
      cols = c("p1Cash":"p1TotalAsset", "p2Cash":"p2TotalAsset"),
      names_to = "money", values_to = "value")
```

.small[
<div id="htmlwidget-37ee950ed757d9949358" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-37ee950ed757d9949358">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606"],[1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,9,9,9,9,9,9,10,10,10,10,10,10,11,11,11,11,11,11,12,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,15,16,16,16,16,16,16,17,17,17,17,17,17,18,18,18,18,18,18,19,19,19,19,19,19,20,20,20,20,20,20,21,21,21,21,21,21,22,22,22,22,22,22,23,23,23,23,23,23,24,24,24,24,24,24,25,25,25,25,25,25,26,26,26,26,26,26,27,27,27,27,27,27,28,28,28,28,28,28,29,29,29,29,29,29,30,30,30,30,30,30,31,31,31,31,31,31,32,32,32,32,32,32,33,33,33,33,33,33,34,34,34,34,34,34,35,35,35,35,35,35,36,36,36,36,36,36,37,37,37,37,37,37,38,38,38,38,38,38,39,39,39,39,39,39,40,40,40,40,40,40,41,41,41,41,41,41,42,42,42,42,42,42,43,43,43,43,43,43,44,44,44,44,44,44,45,45,45,45,45,45,46,46,46,46,46,46,47,47,47,47,47,47,48,48,48,48,48,48,49,49,49,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,52,52,52,52,52,52,53,53,53,53,53,53,54,54,54,54,54,54,55,55,55,55,55,55,56,56,56,56,56,56,57,57,57,57,57,57,58,58,58,58,58,58,59,59,59,59,59,59,60,60,60,60,60,60,61,61,61,61,61,61,62,62,62,62,62,62,63,63,63,63,63,63,64,64,64,64,64,64,65,65,65,65,65,65,66,66,66,66,66,66,67,67,67,67,67,67,68,68,68,68,68,68,69,69,69,69,69,69,70,70,70,70,70,70,71,71,71,71,71,71,72,72,72,72,72,72,73,73,73,73,73,73,74,74,74,74,74,74,75,75,75,75,75,75,76,76,76,76,76,76,77,77,77,77,77,77,78,78,78,78,78,78,79,79,79,79,79,79,80,80,80,80,80,80,81,81,81,81,81,81,82,82,82,82,82,82,83,83,83,83,83,83,84,84,84,84,84,84,85,85,85,85,85,85,86,86,86,86,86,86,87,87,87,87,87,87,88,88,88,88,88,88,89,89,89,89,89,89,90,90,90,90,90,90,91,91,91,91,91,91,92,92,92,92,92,92,93,93,93,93,93,93,94,94,94,94,94,94,95,95,95,95,95,95,96,96,96,96,96,96,97,97,97,97,97,97,98,98,98,98,98,98,99,99,99,99,99,99,100,100,100,100,100,100,101,101,101,101,101,101],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[100,100,100,100,100,100,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,111,111,111,111,111,111,115,115,115,115,115,115,119,119,119,119,119,119,123,123,123,123,123,123,120,120,120,120,120,120,117,117,117,117,117,117,114,114,114,114,114,114,111,111,111,111,111,111,108,108,108,108,108,108,105,105,105,105,105,105,109,109,109,109,109,109,113,113,113,113,113,113,110,110,110,110,110,110,117,117,117,117,117,117,117,117,117,117,117,117,112,112,112,112,112,112,112,112,112,112,112,112,119,119,119,119,119,119,114,114,114,114,114,114,111,111,111,111,111,111,108,108,108,108,108,108,105,105,105,105,105,105,102,102,102,102,102,102,99,99,99,99,99,99,105,105,105,105,105,105,102,102,102,102,102,102,109,109,109,109,109,109,106,106,106,106,106,106,106,106,106,106,106,106,113,113,113,113,113,113,108,108,108,108,108,108,115,115,115,115,115,115,112,112,112,112,112,112,119,119,119,119,119,119,116,116,116,116,116,116,123,123,123,123,123,123,117,117,117,117,117,117,125,125,125,125,125,125,119,119,119,119,119,119,131,131,131,131,131,131,125,125,125,125,125,125,133,133,133,133,133,133,130,130,130,130,130,130,138,138,138,138,138,138,134,134,134,134,134,134,143,143,143,143,143,143,139,139,139,139,139,139,148,148,148,148,148,148,144,144,144,144,144,144,159,159,159,159,159,159,155,155,155,155,155,155,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,142,142,142,142,142,142,142,142,142,142,142,142,134,134,134,134,134,134,141,141,141,141,141,141,133,133,133,133,133,133,140,140,140,140,140,140,132,132,132,132,132,132,125,125,125,125,125,125,129,129,129,129,129,129,122,122,122,122,122,122,129,129,129,129,129,129,117,117,117,117,117,117,121,121,121,121,121,121,109,109,109,109,109,109,115,115,115,115,115,115,104,104,104,104,104,104,108,108,108,108,108,108,102,102,102,102,102,102,106,106,106,106,106,106,100,100,100,100,100,100,103,103,103,103,103,103,97,97,97,97,97,97,102,102,102,102,102,102,92,92,92,92,92,92,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,98,98,98,98,98,98,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,96,96,96,96,96,96,87,87,87,87,87,87,90,90,90,90,90,90,85,85,85,85,85,85,90,90,90,90,90,90,81,81,81,81,81,81],["buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","","","","","",""],["no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","yes","","","","","",""],["no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","buy","buy","buy","buy","buy","buy","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","buy","no trade","no trade","no trade","no trade","no trade","no trade","buy","buy","buy","buy","buy","buy","no trade","no trade","no trade","no trade","no trade","no trade","buy","buy","buy","buy","buy","buy","no trade","no trade","no trade","no trade","no trade","no trade","buy","buy","buy","buy","buy","buy","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","sell","sell","sell","sell","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","buy","buy","buy","buy","buy","buy","no trade","no trade","no trade","no trade","no trade","no trade","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","no trade","buy","buy","buy","buy","buy","buy","sell","sell","sell","sell","sell","sell","","","","","",""],["no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","no","","","","","",""],["p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset","p1Cash","p1Stock","p1TotalAsset","p2Cash","p2Stock","p2TotalAsset"],[10000,10,11000,10000,10,11000,9900,11,11033,10000,10,11030,9797,12,11033,10103,9,11030,9694,13,11033,10206,8,11030,9591,14,11089,10206,8,11062,9484,15,11089,10313,7,11062,9377,16,11089,10420,6,11062,9270,17,11089,10527,5,11062,9163,18,11161,10527,5,11082,9052,19,11237,10527,5,11102,8937,20,11317,10527,5,11122,8818,21,11401,10527,5,11142,8941,20,11341,10527,5,11127,9061,19,11284,10527,5,11112,9178,18,11230,10527,5,11097,9292,17,11179,10527,5,11082,9403,16,11131,10527,5,11067,9511,15,11086,10527,5,11052,9406,16,11150,10527,5,11072,9297,17,11218,10527,5,11092,9410,16,11170,10527,5,11077,9300,17,11289,10527,5,11112,9183,18,11289,10644,4,11112,9300,17,11204,10761,3,11097,9412,16,11204,10649,4,11097,9300,17,11323,10649,4,11125,9419,16,11243,10768,3,11110,9533,15,11198,10768,3,11101,9644,14,11156,10768,3,11092,9752,13,11117,10768,3,11083,9857,12,11081,10768,3,11074,9959,11,11048,10768,3,11065,9860,12,11120,10768,3,11083,9965,11,11087,10768,3,11074,9863,12,11171,10768,3,11095,9972,11,11138,10768,3,11086,9972,11,11138,10768,3,11086,9866,12,11222,10768,3,11107,9979,11,11167,10881,2,11097,9871,12,11251,10881,2,11111,9986,11,11218,10881,2,11105,9874,12,11302,10881,2,11119,9993,11,11269,10881,2,11113,9877,12,11353,10881,2,11127,10000,11,11287,11004,1,11121,9883,12,11383,11004,1,11129,10008,11,11317,11129,0,11129,9889,12,11461,11010,1,11141,10020,11,11395,11141,0,11141,9895,12,11491,11141,0,11141,10028,11,11458,11141,0,11141,9898,12,11554,11141,0,11141,10036,11,11510,11141,0,11141,9902,12,11618,11141,0,11141,10045,11,11574,11141,0,11141,9906,12,11682,11141,0,11141,10054,11,11638,11141,0,11141,9910,12,11818,10997,1,11156,10069,11,11774,10997,1,11152,10224,10,11734,10997,1,11148,10375,9,11734,10846,2,11148,10526,8,11734,10695,3,11148,10677,7,11671,10695,3,11121,10819,6,11671,10553,4,11121,10961,5,11631,10553,4,11089,10827,6,11673,10419,5,11124,10968,5,11633,10419,5,11084,10835,6,11675,10286,6,11126,10975,5,11635,10286,6,11078,11107,4,11607,10286,6,11036,10982,5,11627,10286,6,11060,11111,4,11599,10286,6,11018,10989,5,11634,10164,7,11067,11118,4,11586,10293,6,10995,11001,5,11606,10293,6,11019,11122,4,11558,10414,5,10959,11013,5,11588,10305,6,10995,11128,4,11544,10420,5,10940,11024,5,11564,10420,5,10960,11132,4,11540,10420,5,10930,11030,5,11560,10420,5,10950,11136,4,11536,10420,5,10920,11036,5,11551,10420,5,10935,11139,4,11527,10420,5,10905,11042,5,11552,10323,6,10935,11144,4,11512,10425,5,10885,11052,5,11527,10425,5,10900,11052,5,11527,10425,5,10900,11052,5,11527,10425,5,10900,11052,5,11542,10330,6,10918,11150,4,11522,10330,6,10888,11057,5,11522,10423,5,10888,11057,5,11522,10423,5,10888,11057,5,11522,10423,5,10888,11057,5,11522,10423,5,10888,11057,5,11537,10330,6,10906,11153,4,11501,10426,5,10861,11066,5,11516,10426,5,10876,11156,4,11496,10426,5,10851,11071,5,11521,10341,6,10881,11161,4,11485,10431,5,10836]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Trials<\/th>\n      <th>MarketCondition<\/th>\n      <th>StockPrice<\/th>\n      <th>p1Decision<\/th>\n      <th>p1ChechHistory<\/th>\n      <th>p2Decision<\/th>\n      <th>p2ChechHistory<\/th>\n      <th>money<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"fixedColumns":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
]
]

---

# Practice 2

試著把剛剛同組的 `ebg` 資料，利用 `boxplot(y~group, data)`，依照不同「資產類型」(Cash, Stock, Asset)，畫出它分佈。


```r
boxplot(value ~ money, data = ebg_long)
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-38-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# [Cheetsheet](https://www.rstudio.org/links/data_transformation_cheat_sheet)

.center[![:scale 90%](figure/data-transformation.jpg)]

---

# [Cheetsheet](https://www.rstudio.org/links/data_transformation_cheat_sheet)


.center[![:scale 90%](figure/data-transformation 2.jpg)]

---

# RStudio cheetsheets 

Link: &lt;https://rstudio.com/resources/cheatsheets/&gt;

In RStudio: Help &gt; Cheetsheets &gt; ...

---
class: inverse, center, middle

# ggplot2

---

# Grammar of graphics

.center[![:scale 90%](figure/ggplot.png)]

---

# Grammar of graphics

- 資料來源（data）：指定原始資料來源的 data frame。
- 美學對應（aesthetic）：指定原始資料與圖形之間的對應關係，例如哪一個變數要當作 x 座標變數，而哪一個要當作 y 座標變數，還有資料繪圖時的樣式等。
- 幾何圖案（geometry）：要用什麼幾何圖形繪製資料，例如點、線條、多邊形等。
- 繪圖面（facet）：指定如何將資料分散在多張子圖形中繪製，以利互相比較。
- 統計轉換（statistical transformation）：指定如何以將資料轉換為各種統計量，例如將連續型資料轉為離散型的類別。
- 座標系統（coordinate system）：指定繪圖時所使用的座標系統，除了常見的笛卡兒直角座標系統，也可以使用極坐標或地圖投影（map projection）。
- 主題（theme）：控制資料以外的繪圖組件，例如座標軸、說明文字等。

---

# Data


```r
mtcars
```
.scroll-box-16[
.small[
<div id="htmlwidget-4a4fc816f5932f19d634" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4a4fc816f5932f19d634">{"x":{"filter":"none","data":[["Mazda RX4","Mazda RX4 Wag","Datsun 710","Hornet 4 Drive","Hornet Sportabout","Valiant","Duster 360","Merc 240D","Merc 230","Merc 280","Merc 280C","Merc 450SE","Merc 450SL","Merc 450SLC","Cadillac Fleetwood","Lincoln Continental","Chrysler Imperial","Fiat 128","Honda Civic","Toyota Corolla","Toyota Corona","Dodge Challenger","AMC Javelin","Camaro Z28","Pontiac Firebird","Fiat X1-9","Porsche 914-2","Lotus Europa","Ford Pantera L","Ferrari Dino","Maserati Bora","Volvo 142E"],[21,21,22.8,21.4,18.7,18.1,14.3,24.4,22.8,19.2,17.8,16.4,17.3,15.2,10.4,10.4,14.7,32.4,30.4,33.9,21.5,15.5,15.2,13.3,19.2,27.3,26,30.4,15.8,19.7,15,21.4],[6,6,4,6,8,6,8,4,4,6,6,8,8,8,8,8,8,4,4,4,4,8,8,8,8,4,4,4,8,6,8,4],[160,160,108,258,360,225,360,146.7,140.8,167.6,167.6,275.8,275.8,275.8,472,460,440,78.7,75.7,71.1,120.1,318,304,350,400,79,120.3,95.1,351,145,301,121],[110,110,93,110,175,105,245,62,95,123,123,180,180,180,205,215,230,66,52,65,97,150,150,245,175,66,91,113,264,175,335,109],[3.9,3.9,3.85,3.08,3.15,2.76,3.21,3.69,3.92,3.92,3.92,3.07,3.07,3.07,2.93,3,3.23,4.08,4.93,4.22,3.7,2.76,3.15,3.73,3.08,4.08,4.43,3.77,4.22,3.62,3.54,4.11],[2.62,2.875,2.32,3.215,3.44,3.46,3.57,3.19,3.15,3.44,3.44,4.07,3.73,3.78,5.25,5.424,5.345,2.2,1.615,1.835,2.465,3.52,3.435,3.84,3.845,1.935,2.14,1.513,3.17,2.77,3.57,2.78],[16.46,17.02,18.61,19.44,17.02,20.22,15.84,20,22.9,18.3,18.9,17.4,17.6,18,17.98,17.82,17.42,19.47,18.52,19.9,20.01,16.87,17.3,15.41,17.05,18.9,16.7,16.9,14.5,15.5,14.6,18.6],[0,0,1,1,0,1,0,1,1,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,0,1,0,0,0,1],[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,1,1,1,1,1,1,1],[4,4,4,3,3,3,3,4,4,4,4,3,3,3,3,3,3,4,4,4,3,3,3,3,3,4,5,5,5,5,5,4],[4,4,1,1,2,1,4,2,2,4,4,3,3,3,4,4,4,1,2,1,1,2,2,4,2,1,2,2,4,6,8,2]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mpg<\/th>\n      <th>cyl<\/th>\n      <th>disp<\/th>\n      <th>hp<\/th>\n      <th>drat<\/th>\n      <th>wt<\/th>\n      <th>qsec<\/th>\n      <th>vs<\/th>\n      <th>am<\/th>\n      <th>gear<\/th>\n      <th>carb<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"fixedColumns":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
]
]

---

# ggplot(aes())  


```r
ggplot(mtcars, aes(x = mpg))
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-41-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# geom: histogram


```r
ggplot(mtcars, aes(x = mpg)) +
  geom_histogram()
```

```
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-42-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# geom: density


```r
ggplot(mtcars, aes(x = mpg/length(mpg))) +
  geom_histogram() + geom_density()
```

```
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-43-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# geom: scatter plot


```r
ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point()
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-44-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# aes: color, shape


```r
(g &lt;- ggplot(mtcars, aes(x = wt, y = mpg,
                         color = factor(am), shape = factor(am))) +
  geom_point())
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-45-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# facet


```r
g + facet_wrap(~cyl)
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-46-1.png" width="80%" style="display: block; margin: auto;" /&gt;


---

# stat: linear regression


```r
g1 &lt;- g + stat_smooth(method = "lm")
g1
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-47-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# labs: axis, legend, and plot labels


```r
(g2 &lt;- g1 + 
  labs(title = "Linear regression plot", 
       subtitle = "Exmpal of mtcars dataset",
       x = "Weight (1000 lbs)", y = "Miles/(US) gallon",
       color = "Transmission", shape = "Transmission"))
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-48-1.png" width="80%" style="display: block; margin: auto;" /&gt;


---

# theme


```r
g2 + theme_classic()
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-49-1.png" width="80%" style="display: block; margin: auto;" /&gt;


---

# Practice 3: line chart

試著用折線圖 `geom_line()` 對 `ebg` 這筆資料，看股票價格 (StockPrice) 隨回合數 (Trials) 的變化。

--


```r
ggplot(ebg_g1, aes(x = Trials, y = StockPrice)) +
  geom_line()
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-50-1.png" width="80%" style="display: block; margin: auto;" /&gt;

---

# Practice 4

嘗試先用先前所學的，將 `ebg` 中 p1 和 p2 的現金放在同一個變項中，再利用 `geom_line()` 畫出兩為玩家在第 21 ~ 60 回和的現金變化折線圖。

.scroll-box-16[

```r
ebg_g1 %&gt;% 
  filter(Trials &gt;= 21, Trials &lt; 60) %&gt;% 
  pivot_longer(cols = c("p1Cash", "p2Cash"), 
               names_to = "player", values_to = "cash") %&gt;% 
  ggplot(aes(x = Trials, y = cash, 
             group = player, linetype = player)) + # &lt;&lt;
  geom_line()
```

&lt;img src="tidyverse_intro_files/figure-html/unnamed-chunk-51-1.png" width="80%" style="display: block; margin: auto;" /&gt;
]

---

# References

- `vignette("dplyr", package = "dplyr")`
- `vignette("two-table", package = "dplyr")`
- `vignette("pivot", package = "tidyr")`
- &lt;https://blog.gtwang.org/r/ggplot2-tutorial-layer-by-layer-plotting/&gt;
- R Graphic Cookbook &lt;http://www.cookbook-r.com/Graphs/&gt;
- The R Graph Gallery &lt;https://www.r-graph-gallery.com/&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
